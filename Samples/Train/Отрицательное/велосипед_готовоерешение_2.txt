Зачем мы писали свой велосипед, нужно было сразу использовать готовое решение.